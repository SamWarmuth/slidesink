!!!
%head
  -@show = Slideshow.new if @show.nil?
  -@show.slides ||= []
  
  %script{:src => "/js/jquery-1.4.2.min.js", :type => "text/javascript"}  
  %script{:src => "/js/jquery-ui-1.8.4.custom.min.js", :type => "text/javascript"}
  -if @show.new_document?
    %title SlideSink - New Show
  -else
    %title SlideSink - Edit #{@show.title}
  :css
    #{sass :style}
%body{:style => 'background: #ddd'}
  %form{:action => "/edit", :method => "post", :style => 'width: 825px; margin: 20px auto; background: white; padding: 10px; border-radius: 5px;'}
    %input{:name => "show_id", :value => @show.id, :type => "hidden"}
    -if @show.new_document?
      %h1{:style => 'text-align: center'} New Show
    -else
      %h1{:style => 'text-align: center'} Edit #{@show.title}
    %p
      %label{:for => "title"} Presentation Title
      %input#title.textfield{:name => "title", :type => "text", :value => @show.title, :style => "width: 150px"}
      %label{:for => "url", :style => "margin-left: 50px"} URL
      %input#url.textfield{:name => "url", :type => "text", :value => @show.url, :style => "width: 150px"}
      slidesink.com/your_url
  .guiedit{:style => "margin: 10px auto; width: 845px; height: 450px; position: relative;"}
    %div{:style => "position: absolute; bottom: 26px; left: 0; z-index: 100;"}
      #add-slide.awesome.green.large{:style => "width: 172px; text-align: center; border-radius: 0 0 5px 5px; -webkit-box-shadow: none;"} New Slide
    #slide-list{:style => "display: inline-block; width: 200px; height: 370px; margin-bottom: 34px; background: #BBB; position: relative; border-radius: 5px 5px 0 0; padding: 10px 0; overflow: auto;"}
      -@show.slides.each do |slide|
        .tiny-slide!= slide.html
      
    .slide-viewer{:style => "display: inline-block; width: 640px; height: 424px; position: relative; padding: 0; margin: 0"}
      #active-slide.slide{:style => "margin: 0"}
      #code-cover{:style => "position: absolute; top: 0; left: 0; height: 640px; height: 424px; padding: 0; margin: 0; display: none;"}
        %textarea.tabarea{:style => "font-size: 1em; font-family: monospace; width: 511px; height: 374px; padding: 5px; border: 1px solid #ddd; border-right: none; background: #eee; border-radius: 5px 0 0 5px ; margin: 20px 20px"}
        %div{:style => "position: absolute; top: 20px; left: 542px; z-index: 100;"}
          #save-slide.awesome.green.large{:style => "width: 50px; height: 160px; text-align: center; border-radius: 0 5px 0 0; -webkit-box-shadow: none; padding-top: 130px;"} Keep Changes
          #cancel-slide.awesome.red.large{:style => "width: 50px; height: 40px; text-align: center; border-radius: 0 0 5px 0; -webkit-box-shadow: none; padding-top: 35px;"} Cancel
          
    
    .clear{:style => "clear: both;"}
  .buttons{:style => "width: 500px; margin: auto"}
    %input.awesome.red.large{:type => "submit", :value => "Discard Changes", :style => "display: inline-block; width: 200px"}
    %input.awesome.green.large{:type => "submit", :value => "Save Presentation", :style => "display: inline-block; width: 200px; margin-left: 50px"}
  %br
  %br
    
    
:javascript

  $(document).ready(function(){   
   
    var firstSlide = $(".tiny-slide").first();
    firstSlide.addClass("selected");
    $("#active-slide").html(firstSlide.html());
    
    $("#active-slide").click(function(){
      $("#code-cover").fadeIn(100);
      $("#code-cover textarea").val($("#active-slide").html());
    });
    
    $("#save-slide").click(function(){
      $("#code-cover").fadeOut(100);
      var newHTML = $("#code-cover textarea").val();
      $("#active-slide").html(newHTML);
      $(".tiny-slide.selected").html(newHTML);
    });
    $("#cancel-slide").click(function(){
      $("#code-cover").fadeOut(100);
      $("#code-cover textarea").val("");
    });
    
    $("#add-slide").click(function(){
      $("#slide-list").append("<div class='tiny-slide'><div class='center-title'>" + Math.floor(Math.random()*101) + "</div></div>");
      return false;
    });
    
    $(".tiny-slide").live('click', function(){
      $("#code-cover").fadeOut(100);
      $("#code-cover textarea").val("");
      
      $(".tiny-slide").removeClass("selected");
      $(this).addClass("selected");
      $("#active-slide").html($(this).html());
    });
    
    $(".tabarea").keydown(function(e){
      if (e.keyCode == 9){
        return false;
      }
    });
  });